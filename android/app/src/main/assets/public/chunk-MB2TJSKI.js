import{a as j}from"./chunk-33XRR7PD.js";import{B as E,Q as S,f as P,k as w,p as k,q as x,r as I,u as L}from"./chunk-52UE2MJF.js";import"./chunk-G5DBTQCY.js";import{Ba as v,Ma as _,N as f,Oa as s,Pa as l,Qa as y,S as b,Ua as C,ab as M,fb as g,gb as p,hb as u,l as m,sa as c,x as h,xa as d}from"./chunk-QI2UKG4A.js";import"./chunk-4G7SAIE5.js";import"./chunk-LRSHVU3G.js";import"./chunk-473DEPGT.js";import"./chunk-CKIBZVXW.js";import"./chunk-PS2NURIG.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-6MDLUQIX.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import"./chunk-RW4GY4BD.js";var R=(()=>{let o=class o{constructor(n){this.http=n,this.API_URL="",j.isNativePlatform()?this.API_URL="http://192.168.0.103:5000":this.API_URL="http://192.168.0.103:5000"}login(n,e){let t={correo:n,contrasena:e};return console.log("Enviando solicitud de login a:",`${this.API_URL}/login`),console.log("Datos enviados:",t),this.http.post(`${this.API_URL}/login`,t).pipe(h(i=>(console.error("--- Error en la solicitud de login ---"),console.error("Status:",i.status),console.error("Mensaje de error:",i.message),i.error&&console.error("Respuesta del servidor:",i.error),m(()=>i))))}};o.\u0275fac=function(e){return new(e||o)(b(P))},o.\u0275prov=f({token:o,factory:o.\u0275fac,providedIn:"root"});let r=o;return r})();var z=(()=>{let o=class o{constructor(n,e){this.authService=n,this.router=e,this.correo="",this.contrasena=""}onLogin(){var n;console.log("Bot\xF3n presionado"),console.log("Datos enviados:",{correo:this.correo,contrasena:this.contrasena}),(n=document.activeElement)==null||n.blur(),this.authService.login(this.correo,this.contrasena).subscribe({next:e=>{switch(console.log("Login exitoso",e),localStorage.setItem("user",JSON.stringify(e)),e.rol_id){case 1:this.router.navigate(["/inicioad"]);break;case 2:this.router.navigate(["/inicio-profesor"]);break;case 3:this.router.navigate(["/inicio-alumno"]);break;default:alert("Rol no v\xE1lido"),this.router.navigate(["/login"])}},error:e=>{var i;if(console.error("Error en login:",e),e.status===0){alert(`\u274C Error de conexi\xF3n con el servidor

Verifica si la IP es correcta y si tu servidor Flask est\xE1 encendido.`);return}let t=((i=e==null?void 0:e.error)==null?void 0:i.error)||(e==null?void 0:e.message)||"Error desconocido";switch(e.status){case 400:alert(`\u26A0\uFE0F Solicitud inv\xE1lida: ${t}`);break;case 401:alert(`\u{1F512} Acceso denegado: ${t}`);break;case 404:alert(`\u274C No encontrado: ${t}`);break;case 500:alert(`\u{1F4A5} Error interno en el servidor: ${t}`);break;default:alert(`\u2757 Error inesperado (status ${e.status}): ${t}`)}}})}};o.\u0275fac=function(e){return new(e||o)(d(R),d(w))},o.\u0275cmp=v({type:o,selectors:[["app-login"]],decls:7,vars:3,consts:[[1,"login-container",3,"fullscreen"],[1,"login-card"],["src","assets/logo.svg","alt","Logo",1,"logo"],["placeholder","Usuario","type","email","label","Correo","labelPlacement","floating",3,"ngModelChange","ngModel"],["placeholder","Contrase\xF1a","type","password","label","Contrase\xF1a","labelPlacement","floating",3,"ngModelChange","ngModel"],["expand","block",3,"click"]],template:function(e,t){e&1&&(s(0,"ion-content",0)(1,"div",1),y(2,"img",2),s(3,"ion-input",3),u("ngModelChange",function(a){return p(t.correo,a)||(t.correo=a),a}),l(),s(4,"ion-input",4),u("ngModelChange",function(a){return p(t.contrasena,a)||(t.contrasena=a),a}),l(),s(5,"ion-button",5),C("click",function(){return t.onLogin()}),M(6,"Iniciar sesi\xF3n"),l()()()),e&2&&(_("fullscreen",!0),c(3),g("ngModel",t.correo),c(),g("ngModel",t.contrasena))},dependencies:[L,S,E,I,k,x],styles:[".login-container[_ngcontent-%COMP%]{--background: rgb(255, 255, 255);display:flex;justify-content:center;align-items:center;height:100vh;width:100vw}.login-card[_ngcontent-%COMP%]{background:#d5d5d5;padding:20px;border-radius:12px;width:90%;max-width:350px;text-align:center;box-shadow:0 4px 10px #0000001a;color:#000;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.logo[_ngcontent-%COMP%]{width:120px;margin-bottom:15px}ion-input[_ngcontent-%COMP%]{margin:10px 0;--border-radius: 8px;--padding-start: 15px}ion-button[_ngcontent-%COMP%]{--border-radius: 8px;font-size:16px;--background: rgb(255, 255, 255)}"]});let r=o;return r})();export{z as LoginPage};
